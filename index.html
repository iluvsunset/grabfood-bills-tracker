<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GrabFood Bills Portal</title>
<link rel="stylesheet" href="styles.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
<div id="particles"></div>

<!-- LOGIN SCREEN -->
<div id="loginScreen">
  <div class="login-container">
    <h1>ğŸ” Grab Bills Tracker</h1>
    <p>Track all your Grab orders in one place</p>
    <button id="googleSignInBtn">
      <svg width="20" height="20" viewBox="0 0 24 24">
        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
      </svg>
      Sign in with Google
    </button>
  </div>
</div>

<!-- MAIN APP -->
<div id="mainApp">
  <!-- Header -->
  <div class="app-header">
    <div class="user-info">
      <span>ğŸ‘¤</span>
      <span id="userEmail">user@example.com</span>
    </div>
    <div style="display: flex; gap: 10px;">
      <button id="syncGmailBtn" class="sync-btn">ğŸ”„ Sync Gmail</button>
      <button id="signOutBtn" class="sign-out-btn">Sign Out</button>
    </div>
  </div>
  
  <!-- Navigation Tabs -->
  <div class="nav-tabs">
    <button class="nav-tab active" data-tab="bills">ğŸ“‹ Bills</button>
    <button class="nav-tab" data-tab="analytics">ğŸ“Š Analytics</button>
    <button class="nav-tab" data-tab="favorites">â­ Favorites</button>
    <button class="nav-tab" data-tab="budget">ğŸ’° Budget</button>
  </div>

  <!-- BILLS TAB -->
  <div class="tab-content active" id="billsTab">
    <div class="content-wrapper">
      <h1>ğŸ” Grab Bills Tracker</h1>
      
      
      <!-- Stats Bar -->
      <div class="stats-bar" id="statsBar" style="display: none;">
        <div class="stat-card">
          <div class="stat-value" id="totalBills">0</div>
          <div class="stat-label">Total Bills</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="monthBills">0</div>
          <div class="stat-label">This Month</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="monthSpending">â‚«0</div>
          <div class="stat-label">Month Spending</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="avgOrder">â‚«0</div>
          <div class="stat-label">Avg Order</div>
        </div>
      </div>
      
      <!-- Month Timeline -->
      <div class="timeline-wrapper">
        <button id="scrollLeftBtn" class="scroll-nav-btn">â€¹</button>
        <div class="month-timeline" id="monthTimeline"></div>
        <button id="scrollRightBtn" class="scroll-nav-btn">â€º</button>
      </div>
      
      <!-- Search & Filter Bar -->
      <div class="search-filter-bar" id="searchContainer">
        <input 
          type="text" 
          id="searchInput"
          class="search-input"
          placeholder="ğŸ” Search by store, date, or items..."
        >
        <button id="aiPickBtn" class="ai-btn">ğŸ”® AI Pick</button>
        <button id="filterBtn" class="filter-btn">ğŸ›ï¸ Filters</button>
        <button id="exportBtn" class="export-btn">ğŸ“¥ Export</button>
      </div>

      <!-- Advanced Filters (Hidden by default) -->
      <div class="filters-panel" id="filtersPanel" style="display: none;">
        <h3>Advanced Filters</h3>
        <div class="filter-grid">
          <div class="filter-item">
  <label>Bill Type</label>
  <select id="billTypeFilter">
    <option value="all">All Types</option>
    <option value="GrabFood">ğŸ½ï¸ GrabFood</option>
    <option value="GrabBike">ğŸï¸ GrabBike</option>
    <option value="GrabCar">ğŸš— GrabCar</option>
    <option value="GrabExpress">ğŸ“¦ GrabExpress</option>
    <option value="GrabMart">ğŸ›’ GrabMart</option>
    <option value="GrabPay">ğŸ’³ GrabPay</option>
    <option value="Grab">ğŸŸ¢ Other Grab Services</option>
  </select>
</div>
          <div class="filter-item">
            <label>Price Range</label>
            <div class="price-range">
              <input type="number" id="minPrice" placeholder="Min â‚«">
              <span>-</span>
              <input type="number" id="maxPrice" placeholder="Max â‚«">
            </div>
          </div>
          <div class="filter-item">
            <label>Date Range</label>
            <div class="date-range">
              <input type="date" id="startDate">
              <span>to</span>
              <input type="date" id="endDate">
            </div>
          </div>
          <div class="filter-item">
            <label>Sort By</label>
            <select id="sortBy">
              <option value="date-desc">Date (Newest)</option>
              <option value="date-asc">Date (Oldest)</option>
              <option value="price-desc">Price (High to Low)</option>
              <option value="price-asc">Price (Low to High)</option>
              <option value="store">Store Name</option>
            </select>
          </div>
        </div>
        <div class="filter-actions">
          <button id="applyFilters" class="apply-btn">Apply Filters</button>
          <button id="clearFilters" class="clear-btn">Clear All</button>
        </div>
      </div>
      
      
      <!-- Bill List -->
      <div id="billList"></div>
      
      <!-- Bill Detail -->
      <div id="billDetail"></div>
    </div>
  </div>

  <!-- ANALYTICS TAB -->
  <div class="tab-content" id="analyticsTab">
    <div class="content-wrapper">
      <h1>ğŸ“Š Analytics Dashboard</h1>
      
      <!-- Analytics Period Selector -->
      <div class="period-selector">
        <button class="period-btn active" data-period="month">This Month</button>
        <button class="period-btn" data-period="3months">Last 3 Months</button>
        <button class="period-btn" data-period="6months">Last 6 Months</button>
        <button class="period-btn" data-period="year">This Year</button>
        <button class="period-btn" data-period="all">All Time</button>
      </div>

      <!-- Quick Stats Grid -->
      <div class="analytics-grid">
        <div class="analytics-card">
          <div class="card-icon">ğŸ’°</div>
          <div class="card-content">
            <div class="card-label">Total Spending</div>
            <div class="card-value" id="analyticsTotal">â‚«0</div>
            <div class="card-change" id="analyticsTotalChange">-</div>
          </div>
        </div>
        
        <div class="analytics-card">
          <div class="card-icon">ğŸ“¦</div>
          <div class="card-content">
            <div class="card-label">Total Orders</div>
            <div class="card-value" id="analyticsOrders">0</div>
            <div class="card-change" id="analyticsOrdersChange">-</div>
          </div>
        </div>
        
        <div class="analytics-card">
          <div class="card-icon">ğŸ“Š</div>
          <div class="card-content">
            <div class="card-label">Average Order</div>
            <div class="card-value" id="analyticsAvg">â‚«0</div>
            <div class="card-change" id="analyticsAvgChange">-</div>
          </div>
        </div>
        
        <div class="analytics-card">
          <div class="card-icon">ğŸ†</div>
          <div class="card-content">
            <div class="card-label">Top Store</div>
            <div class="card-value" id="analyticsTopStore">-</div>
            <div class="card-subtext" id="analyticsTopStoreCount">-</div>
          </div>
        </div>
      </div>

      <!-- Spending Heatmap -->
      <div class="heatmap-section">
        <h3>ğŸ”¥ Spending Intensity (This Year)</h3>
        <div class="heatmap-wrapper">
          <div class="heatmap-days">
            <span>Mon</span>
            <span>Wed</span>
            <span>Fri</span>
          </div>
          <div class="heatmap-content">
            <div class="heatmap-months" id="heatmapMonths"></div>
            <div class="heatmap-scroll" id="spendingHeatmap"></div>
          </div>
        </div>
        <div class="heatmap-legend">
          <span>Less</span>
          <div class="legend-scale">
            <div class="l-0"></div>
            <div class="l-1"></div>
            <div class="l-2"></div>
            <div class="l-3"></div>
            <div class="l-4"></div>
          </div>
          <span>More</span>
        </div>
      </div>

      <!-- Charts Section -->
      <div class="charts-grid">
        <!-- Spending Trend Chart -->
        <div class="chart-container">
          <h3>ğŸ“ˆ Spending Trend</h3>
          <canvas id="spendingTrendChart"></canvas>
        </div>

        <!-- Store Distribution Chart -->
        <div class="chart-container">
          <h3>ğŸª Top Stores</h3>
          <canvas id="storeDistributionChart"></canvas>
        </div>

        <!-- Day of Week Chart -->
        <div class="chart-container">
          <h3>ğŸ“… Orders by Day of Week</h3>
          <canvas id="dayOfWeekChart"></canvas>
        </div>

        <!-- Time of Day Chart -->
        <div class="chart-container">
          <h3>â° Orders by Time of Day</h3>
          <canvas id="timeOfDayChart"></canvas>
        </div>
      </div>

      <!-- Insights Section -->
      <div class="insights-section">
        <h3>ğŸ’¡ Insights</h3>
        <div id="insightsList" class="insights-list"></div>
      </div>

      <!-- Top Items Section -->
      <div class="top-items-section">
        <h3>ğŸ½ï¸ Most Ordered Items</h3>
        <div id="topItemsList" class="top-items-list"></div>
      </div>
    </div>
  </div>

  <!-- FAVORITES TAB -->
  <div class="tab-content" id="favoritesTab">
    <div class="content-wrapper">
      <h1>â­ Favorite Stores</h1>
      
      <div class="favorites-grid" id="favoritesList">
        <div class="empty-state">
          <div class="empty-state-icon">â­</div>
          <div class="empty-state-text">No favorites yet</div>
          <div class="empty-state-subtext">Star your favorite stores from the bills list</div>
        </div>
      </div>

      <h2 style="margin-top: 40px;">ğŸ“ Custom Lists</h2>
      <div class="lists-section">
        <button id="createListBtn" class="create-list-btn">+ Create New List</button>
        <div id="customLists" class="custom-lists"></div>
      </div>
    </div>
  </div>

  <!-- BUDGET TAB -->
  <div class="tab-content" id="budgetTab">
    <div class="content-wrapper">
      <h1>ğŸ’° Budget Tracking</h1>
      
      <!-- Budget Setup -->
      <div class="budget-setup">
        <h3>Monthly Budget</h3>
        <div class="budget-input-group">
          <input type="number" id="budgetAmount" placeholder="Enter monthly budget (â‚«)">
          <button id="setBudgetBtn" class="set-budget-btn">Set Budget</button>
        </div>
        <div id="budgetStatus" class="budget-status"></div>
      </div>

      <!-- Budget Progress -->
      <div class="budget-progress-card" id="budgetProgressCard" style="display: none;">
        <h3>This Month's Budget</h3>
        <div class="budget-visual">
          <div class="budget-bar">
            <div class="budget-bar-fill" id="budgetBarFill"></div>
          </div>
          <div class="budget-numbers">
            <span id="budgetSpent">â‚«0</span>
            <span>/</span>
            <span id="budgetTotal">â‚«0</span>
          </div>
          <div class="budget-percentage" id="budgetPercentage">0%</div>
        </div>
        <div class="budget-remaining" id="budgetRemaining"></div>
        <div class="budget-projection" id="budgetProjection"></div>
      </div>

      <!-- Budget Alerts -->
      <div class="budget-alerts" id="budgetAlerts"></div>

      <!-- Spending by Category -->
      <div class="spending-breakdown">
        <h3>Monthly Spending History</h3>
        <canvas id="budgetHistoryChart"></canvas>
      </div>

      <!-- Savings Tips -->
      <div class="savings-tips">
        <h3>ğŸ’¡ Savings Tips</h3>
        <div id="savingsTips" class="tips-list"></div>
      </div>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div id="loading">
    <div class="spinner-container">
      <div class="reactor-ring ring-1"></div>
      <div class="reactor-ring ring-2"></div>
      <div class="reactor-ring ring-3"></div>
      <div class="reactor-ring ring-4"></div>
      <div class="reactor-core"></div>
    </div>
    <div class="loading-text">Loading System</div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Modals -->
<div class="modal" id="exportModal">
  <div class="modal-content">
    <h2>ğŸ“¥ Export Bills</h2>
    <p>Choose export format:</p>
    <div class="export-options">
      <button id="exportCSV" class="export-option-btn">
        <span>ğŸ“„</span>
        <span>CSV</span>
      </button>
      <button id="exportJSON" class="export-option-btn">
        <span>ğŸ“‹</span>
        <span>JSON</span>
      </button>
    </div>
    <button class="modal-close" id="closeExportModal">Cancel</button>
  </div>
</div>

<div class="modal" id="createListModal">
  <div class="modal-content">
    <h2>ğŸ“ Create Custom List</h2>
    <input type="text" id="listName" placeholder="List name (e.g., Work Lunches)">
    <div class="modal-actions">
      <button id="saveListBtn" class="primary-btn">Create</button>
      <button class="modal-close" id="closeListModal">Cancel</button>
    </div>
  </div>
</div>

<div class="modal" id="predictorModal">
  <div class="modal-content">
    <h2 style="text-align: center; color: #7b2ff7;">ğŸ”® AI Cravings Predictor</h2>
    <div class="predictor-content">
      <div class="predictor-scanner">
        <div class="scanner-beam"></div>
      </div>
      <p id="predictorStatus" style="color: #00ffff; letter-spacing: 1px;">INITIALIZING SCAN...</p>
      <div class="predictor-result" id="predictorResult"></div>
      <div class="prediction-details" id="predictionDetails"></div>
    </div>
    <div class="modal-actions">
      <button class="modal-close" id="closePredictorModal" style="width: 100%; border-color: #7b2ff7; color: #fff;">Close Protocol</button>
    </div>
  </div>
</div>

<script type="module" src="./app-with-auth.js"></script>
</body>
</html>